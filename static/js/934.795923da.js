(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[934],{7045:function(t,e,s){var a=s(6339),o=s(3070);t.exports=function(t,e,s){return s.get&&a(s.get,e,{getter:!0}),s.set&&a(s.set,e,{setter:!0}),o.f(t,e,s)}},7066:function(t,e,s){"use strict";var a=s(9670);t.exports=function(){var t=a(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},2087:function(t,e,s){var a=s(7854),o=s(9781),l=s(7045),i=s(7066),n=s(7293),p=a.RegExp,r=p.prototype,d=o&&n((function(){var t=!0;try{p(".","d")}catch(d){t=!1}var e={},s="",a=t?"dgimsy":"gimsy",o=function(t,a){Object.defineProperty(e,t,{get:function(){return s+=a,!0}})},l={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var i in t&&(l.hasIndices="d"),l)o(i,l[i]);var n=Object.getOwnPropertyDescriptor(r,"flags").get.call(e);return n!==a||s!==a}));d&&l(r,"flags",{configurable:!0,get:i})},9934:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return lt}});var a=s(3396),o=s(7139);const l={class:"container d-flex pb-2",style:{"flex-direction":"column",height:"calc(100vh - 58px - 4.5rem)"}},i=(0,a._)("h1",null,"Exploits",-1),n={class:"container mt-3 m-0 p-0"},p={class:"row"},r={class:"col-11 pe-0"},d=(0,a._)("i",{class:"bi-plus-lg"},null,-1),c={class:"col-1 ps-1"},u=(0,a._)("i",{class:"bi bi-diagram-3-fill"},null,-1),g=[u],m={class:"mt-3",style:{flex:"0 1 auto","overflow-y":"auto"}},h={role:"button",class:"d-flex justify-content-between align-items-bottom mb-2"},x={class:"d-flex m-0 p-0 mt-1"},b=["value"],f={class:"text-start m-0 p-0"},w=(0,a._)("button",{class:"btn btn-success",role:"button"},[(0,a._)("i",{class:"h6 bi-clipboard2-fill"})],-1);function y(t,e,s,u,y,S){const E=(0,a.up)("ExploitCard"),v=(0,a.up)("Modal");return(0,a.wg)(),(0,a.iD)("div",l,[i,(0,a._)("div",n,[(0,a._)("div",p,[(0,a._)("div",r,[(0,a._)("button",{class:"btn btn-success w-100",role:"button",onClick:e[0]||(e[0]=(...t)=>S.addExploit&&S.addExploit(...t))},[d,(0,a.Uk)(" Add Exploit ")])]),(0,a._)("div",c,[(0,a._)("button",{class:"col-1 btn btn-success w-100",role:"button","data-bs-target":"#template-modal","data-bs-toggle":"modal",onClick:e[1]||(e[1]=(...e)=>t.showTemplateModal&&t.showTemplateModal(...e))},g)])])]),(0,a._)("div",m,[0!=y.exploits.length&&0!=y.exploitsStats.length?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(y.exploits,(t=>((0,a.wg)(),(0,a.j4)(E,{class:"exploit","prop-exploit":t,"prop-flags-count":y.exploitsStats.find((e=>e.id==t.id)),"prop-selected-teams":y.exploitsTeams[t.id]},null,8,["prop-exploit","prop-flags-count","prop-selected-teams"])))),256)):(0,a.kq)("",!0)]),(0,a.Wm)(v,{"prop-center":"","prop-title":"Templates","prop-id":"template-modal"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y.templates,((t,s)=>((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("div",x,[(0,a._)("textarea",{class:"m-0 p-0",style:{opacity:"0",width:"1px",height:"1px"},onFocus:e[2]||(e[2]=t=>t.target.select()),ref_for:!0,ref:"clone",readonly:"",value:t.source},null,40,b),(0,a._)("h5",f,(0,o.zw)(t.name),1)]),w])))),256))])),_:1})])}s(7658);var S=s(4806),E=s(8661),v=s(2237),_=s(1120);s(2087);const T=t=>((0,a.dD)("data-v-5d9c5f33"),t=t(),(0,a.Cn)(),t),k={class:"card-body py-0 px-3 d-flex align-items-center"},C={class:"d-flex justify-content-between align-items-center w-100"},D={class:"m-0"},F={class:"d-flex",style:{gap:"0.5rem"}},z={class:"me-2 mr-2 d-flex my-auto",style:{gap:".5rem"}},j=T((()=>(0,a._)("i",{class:"m-0 h5 bi-pencil-fill"},null,-1))),$=[j],P=T((()=>(0,a._)("i",{class:"m-0 h5 bi-bar-chart-line-fill"},null,-1))),I=[P],Y=T((()=>(0,a._)("i",{class:"m-0 h4 bi-stop-fill"},null,-1))),M=[Y],N=T((()=>(0,a._)("i",{class:"m-0 h4 bi-play-fill"},null,-1))),W=[N];function Z(t,e,s,l,i,n){return(0,a.wg)(),(0,a.iD)("div",{class:(0,o.C_)(["card",{"border border-2 border-danger":i.logStatus===i.logStatusEnum.danger,"border border-2 border-warning":i.logStatus===i.logStatusEnum.warning}]),style:{height:"75px"}},[(0,a._)("div",k,[(0,a._)("div",C,[(0,a._)("h4",D,(0,o.zw)(s.propExploit.name),1),(0,a._)("div",F,[(0,a._)("div",z,[void 0!==s.propSelectedTeams&&void 0!==i.exploitedTeams?((0,a.wg)(),(0,a.iD)("span",{key:0,style:{"min-width":"7.5rem"},class:(0,o.C_)(["text-light badge text-center",{"bg-secondary":i.selectedTeamsStatus===i.logStatusEnum.off,"bg-warning text-dark":i.selectedTeamsStatus===i.logStatusEnum.warning,"bg-danger":i.selectedTeamsStatus===i.logStatusEnum.danger}])}," Attacking: "+(0,o.zw)(i.exploitedTeams.length)+" / "+(0,o.zw)(s.propSelectedTeams.length),3)):(0,a.kq)("",!0),s.propFlagsCount?((0,a.wg)(),(0,a.iD)("span",{key:1,style:{"min-width":"8rem"},class:(0,o.C_)(["text-light badge text-center",{"bg-secondary":i.flagsStatus===i.logStatusEnum.off,"bg-warning text-dark":i.flagsStatus===i.logStatusEnum.warning,"bg-danger":i.flagsStatus===i.logStatusEnum.danger}])}," Last round: "+(0,o.zw)(s.propFlagsCount.flags),3)):(0,a.kq)("",!0)]),(0,a._)("button",{onClick:e[0]||(e[0]=(...t)=>n.loadEditPage&&n.loadEditPage(...t)),class:"size44x44 btn btn-primary",role:"button"},$),(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>n.loadStatsPage&&n.loadStatsPage(...t)),class:"size44x44 btn btn-primary",role:"button"},I),s.propExploit.status?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:e[2]||(e[2]=(...t)=>n.stopExploit&&n.stopExploit(...t)),class:"size44x44 btn btn-danger",role:"button"},M)):((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:e[3]||(e[3]=(...t)=>n.startExploit&&n.startExploit(...t)),class:"size44x44 btn btn-success",role:"button"},W))])])])],2)}const q=20,A={off:-1,normal:0,warning:1,danger:2};var B={name:"ExploitCard",data(){return{exploitedTeams:void 0,logStatusEnum:A,logStatus:A.off,patchedTeamsStatus:A.off,selectedTeamsStatus:A.off,flagsStatus:A.off}},watch:{propExploit:{immediate:!0,handler(t,e){this.updateWarning()}}},props:["propExploit","propFlagsCount","propSelectedTeams"],methods:{loadEditPage(){this.$router.push({name:"exploit-edit",params:{id:this.propExploit.id}})},loadStatsPage(){this.$router.push({name:"exploit-stats",params:{id:this.propExploit.id}})},loadTeamsPage(){this.$router.push({name:"exploit-teams",params:{id:this.propExploit.id}})},async startExploit(){await E.h.put(`/exploits/${this.propExploit.id}/state?status=1`),this.propExploit.status=1},async stopExploit(){await E.h.put(`/exploits/${this.propExploit.id}/state?status=0`),this.propExploit.status=0},async getExploitedTeams(){let t=await E.h.get(`/stats/flags/script/${this.propExploit.id}/teams`);if(200!==t.status)return void(this.exploitedTeams=[]);let e=await t.json();this.exploitedTeams=e},alertPatchedTeams(){alert(1)},async updateWarning(){if(1===this.propExploit.status){0===this.propFlagsCount?this.flagsStatus=A.danger:this.propFlagsCount<q&&(this.flagsStatus=A.warning),0===this.propSelectedTeams.length&&(this.selectedTeamsStatus=A.danger);let t=await E.h.get(`/stats/flags/script/${this.propExploit.id}/teams`);200===t.status?(t=await t.json(),console.log(t),t.length<this.propSelectedTeams.length&&(this.patchedTeamsStatus=A.warning)):this.patchedTeamsStatus=A.off,this.logStatus=Math.max(this.selectedTeamsStatus,this.flagsStatus,this.patchedTeamsStatus)}else this.flagsStatus=A.off,this.selectedTeamsStatus=A.off,this.patchedTeamsStatus=A.off,this.logStatus=A.off}},mounted(){this.getExploitedTeams(),this.updateWarning()}},L=s(89);const O=(0,L.Z)(B,[["render",Z],["__scopeId","data-v-5d9c5f33"]]);var H=O;const K=["id"],R={class:"modal-content"},U={class:"modal-header"},G={class:"modal-title fs-5",id:"exampleModalLabel"},J=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Q={class:"modal-body"},V={class:"modal-footer"};function X(t,e,s,l,i,n){return(0,a.wg)(),(0,a.iD)("div",{class:"modal",id:s.propId,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,a._)("div",{class:(0,o.C_)(["modal-dialog",{"modal-dialog-centered":s.propCenter}])},[(0,a._)("div",R,[(0,a._)("div",U,[(0,a._)("h1",G,(0,o.zw)(s.propTitle),1),J]),(0,a._)("div",Q,[(0,a.WI)(t.$slots,"default")]),(0,a._)("div",V,[void 0!==s.propNopFunc?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:e[0]||(e[0]=(...t)=>s.propNopFunc&&s.propNopFunc(...t)),type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},(0,o.zw)(s.propNopText),1)):(0,a.kq)("",!0),void 0!==s.propYepFunc?((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>s.propYepFunc&&s.propYepFunc(...t)),type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},(0,o.zw)(s.propYepText),1)):(0,a.kq)("",!0)])])],2)],8,K)}var tt={props:{propTitle:String,propId:String,propYepText:String,propYepFunc:Function,propNopText:String,propNopFunc:Function,propCenter:Boolean},data(){return{}}};const et=(0,L.Z)(tt,[["render",X]]);var st=et,at={name:"Exploits",components:{ExploitCard:H,Modal:st},data(){return{templates:v.Z.templates,exploits:[],exploitsTeams:{},exploitsStats:[],websocket:null}},methods:{async getExploitsData(){let t=await(await E.h.get("/exploits/")).json(),e=await(await E.h.get("/exploits/state")).json();this.exploitsTeams=await(await E.h.get("/exploits/teams")).json(),this.exploits=S.merge(S.keyBy(t,"id"),S.keyBy(e,"id"))},async addExploit(){let t=await E.h.post("/exploits/",{name:"service-p0-v0-name",source:"",threads:8,timeout:60,runperiod:30});t=parseInt(await t.text()),_.Z.push({name:"exploit-edit",params:{id:t}})},async getExploitStatus(){let t=parseInt(Date.now()/1e3)-parseInt(Date.now()/1e3)%120-120,e=await E.h.get(`/stats/flags/scripts/time/${t}`);this.exploitsStats=await e.json()},async copyToClipboard(t){console.log(this.$refs.clone),this.$refs.clone[t].focus(),document.execCommand("copy")}},async mounted(){await this.getExploitsData(),await this.getExploitStatus(),this.websocket=new WebSocket(v.Z.websocket_url),this.websocket.onmessage=async t=>{await this.getExploitsData(),await this.getExploitStatus()}},async unmounted(){this.websocket.close()}};const ot=(0,L.Z)(at,[["render",y]]);var lt=ot}}]);
//# sourceMappingURL=934.795923da.js.map